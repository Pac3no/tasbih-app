<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#064e3b">
    <title>Digital Tasbih</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ðŸ“¿</text></svg>">
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            height: 100vh;
            height: 100dvh; /* Dynamic viewport height for mobile browsers */
            width: 100vw;
            position: fixed;
            overscroll-behavior: none;
        }

        #root {
            height: 100%;
            width: 100%;
            overflow: hidden;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, rgba(52, 211, 153, 0.5), rgba(45, 212, 191, 0.5));
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, rgba(52, 211, 153, 0.7), rgba(45, 212, 191, 0.7));
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .animate-pulse {
            animation: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide Icons as React components
        const Moon = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
        );

        const Home = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
        );

        const History = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                <path d="M3 3v5h5"></path>
                <path d="M12 7v5l4 2"></path>
            </svg>
        );

        const Settings = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
        );

        const RotateCcw = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                <path d="M3 3v5h5"></path>
            </svg>
        );

        const Plus = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M5 12h14"></path>
                <path d="M12 5v14"></path>
            </svg>
        );

        const Trash2 = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 6h18"></path>
                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                <line x1="10" x2="10" y1="11" y2="17"></line>
                <line x1="14" x2="14" y1="11" y2="17"></line>
            </svg>
        );

        const Edit2 = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path>
                <path d="m15 5 4 4"></path>
            </svg>
        );

        const TasbihApp = () => {
            // Default dhikr phrases
            const defaultDhikr = [
                { id: 1, phrase: 'Astaghfirullah', translation: 'I seek forgiveness from Allah', goal: 100 },
                { id: 2, phrase: 'SubhanAllah', translation: 'Glory be to Allah', goal: 33 },
                { id: 3, phrase: 'Alhamdulillah', translation: 'All praise be to Allah', goal: 33 },
                { id: 4, phrase: 'Allahu Akbar', translation: 'Allah is the Greatest', goal: 33 }
            ];

            const [dhikrList, setDhikrList] = useState(defaultDhikr);
            const [selectedDhikr, setSelectedDhikr] = useState(dhikrList[0]);
            const [count, setCount] = useState(0);
            const [history, setHistory] = useState([]);
            const [showHistory, setShowHistory] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [vibrationEnabled, setVibrationEnabled] = useState(true);
            const [showAddDhikr, setShowAddDhikr] = useState(false);
            const [newDhikr, setNewDhikr] = useState({
                phrase: '',
                translation: '',
                goal: 33
            });
            const [editingDhikr, setEditingDhikr] = useState(null);
            const [editForm, setEditForm] = useState({
                phrase: '',
                translation: '',
                goal: 33
            });

            // Load data from localStorage on mount
            useEffect(() => {
                const savedHistory = localStorage.getItem('tasbihHistory');
                if (savedHistory) {
                    setHistory(JSON.parse(savedHistory));
                }
            }, []);

            // Haptic feedback function
            const triggerHaptic = () => {
                if (vibrationEnabled && navigator.vibrate) {
                    navigator.vibrate(10);
                }
            };

            // Increment counter
            const incrementCount = () => {
                const newCount = count + 1;
                setCount(newCount);
                triggerHaptic();

                // Check if goal reached
                if (newCount === selectedDhikr.goal) {
                    if (navigator.vibrate) {
                        navigator.vibrate([100, 50, 100]);
                    }
                    
                    // Save to history
                    const historyEntry = {
                        id: Date.now(),
                        phrase: selectedDhikr.phrase,
                        count: newCount,
                        goal: selectedDhikr.goal,
                        date: new Date().toISOString(),
                        completed: true
                    };
                    
                    const newHistory = [historyEntry, ...history];
                    setHistory(newHistory);
                    localStorage.setItem('tasbihHistory', JSON.stringify(newHistory));
                }
            };

            // Reset counter
            const resetCount = () => {
                if (count > 0 && count < selectedDhikr.goal) {
                    // Save incomplete session to history
                    const historyEntry = {
                        id: Date.now(),
                        phrase: selectedDhikr.phrase,
                        count: count,
                        goal: selectedDhikr.goal,
                        date: new Date().toISOString(),
                        completed: false
                    };
                    
                    const newHistory = [historyEntry, ...history];
                    setHistory(newHistory);
                    localStorage.setItem('tasbihHistory', JSON.stringify(newHistory));
                }
                setCount(0);
                triggerHaptic();
            };

            // Change dhikr selection
            const selectDhikr = (dhikr) => {
                setSelectedDhikr(dhikr);
                setCount(0);
            };

            // Update goal for selected dhikr
            const updateGoal = (newGoal) => {
                const updated = dhikrList.map(d => 
                    d.id === selectedDhikr.id ? { ...d, goal: parseInt(newGoal) } : d
                );
                setDhikrList(updated);
                setSelectedDhikr({ ...selectedDhikr, goal: parseInt(newGoal) });
            };

            // Clear history
            const clearHistory = () => {
                setHistory([]);
                localStorage.removeItem('tasbihHistory');
            };

            // Add new dhikr
            const addNewDhikr = () => {
                if (newDhikr.phrase.trim() === '') return;
                
                const dhikrToAdd = {
                    id: Date.now(),
                    phrase: newDhikr.phrase,
                    translation: newDhikr.translation || 'Custom dhikr',
                    goal: parseInt(newDhikr.goal)
                };
                
                setDhikrList([...dhikrList, dhikrToAdd]);
                setNewDhikr({ phrase: '', translation: '', goal: 33 });
                setShowAddDhikr(false);
            };

            // Delete dhikr
            const deleteDhikr = (id) => {
                if (dhikrList.length <= 1) {
                    alert('You must have at least one dhikr');
                    return;
                }
                
                const updated = dhikrList.filter(d => d.id !== id);
                setDhikrList(updated);
                
                // If deleted dhikr was selected, select the first one
                if (selectedDhikr.id === id) {
                    setSelectedDhikr(updated[0]);
                    setCount(0);
                }
            };

            // Start editing a dhikr
            const startEditingDhikr = (dhikr) => {
                setEditingDhikr(dhikr.id);
                setEditForm({
                    phrase: dhikr.phrase,
                    translation: dhikr.translation,
                    goal: dhikr.goal
                });
            };

            // Update dhikr after editing
            const updateDhikr = () => {
                if (editForm.phrase.trim() === '') return;
                
                const updated = dhikrList.map(d => 
                    d.id === editingDhikr 
                        ? { ...d, phrase: editForm.phrase, translation: editForm.translation, goal: parseInt(editForm.goal) }
                        : d
                );
                
                setDhikrList(updated);
                
                // If edited dhikr was selected, update it
                if (selectedDhikr.id === editingDhikr) {
                    setSelectedDhikr({
                        ...selectedDhikr,
                        phrase: editForm.phrase,
                        translation: editForm.translation,
                        goal: parseInt(editForm.goal)
                    });
                }
                
                setEditingDhikr(null);
                setEditForm({ phrase: '', translation: '', goal: 33 });
            };

            // Cancel editing
            const cancelEditing = () => {
                setEditingDhikr(null);
                setEditForm({ phrase: '', translation: '', goal: 33 });
            };

            // Format date
            const formatDate = (dateString) => {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            };

            // Calculate progress percentage
            const progress = (count / selectedDhikr.goal) * 100;

            return (
                <div className="min-h-screen h-screen max-h-screen bg-gradient-to-br from-gray-900 via-emerald-950 to-teal-950 flex flex-col relative overflow-hidden">
                    {/* Animated Background Elements */}
                    <div className="absolute inset-0 overflow-hidden pointer-events-none">
                        <div className="absolute top-20 left-10 w-72 h-72 bg-emerald-500/10 rounded-full blur-3xl animate-pulse"></div>
                        <div className="absolute bottom-20 right-10 w-96 h-96 bg-teal-500/10 rounded-full blur-3xl animate-pulse" style={{animationDelay: '1s'}}></div>
                        <div className="absolute top-1/2 left-1/2 w-64 h-64 bg-cyan-500/10 rounded-full blur-3xl animate-pulse" style={{animationDelay: '2s'}}></div>
                    </div>

                    {/* Header */}
                    <div className="relative backdrop-blur-xl bg-gradient-to-r from-emerald-600/20 to-teal-600/20 border-b border-emerald-500/30 p-4 shadow-2xl flex-shrink-0">
                        <div className="flex items-center justify-between max-w-md mx-auto">
                            <div className="flex items-center gap-2">
                                <div className="relative">
                                    <div className="w-6 h-6 text-emerald-400" style={{filter: 'drop-shadow(0 0 8px rgba(52,211,153,0.8))'}}>
                                        <Moon />
                                    </div>
                                    <div className="absolute inset-0 bg-emerald-400 blur-md opacity-50"></div>
                                </div>
                                <h1 className="text-xl font-bold bg-gradient-to-r from-emerald-400 to-teal-400 bg-clip-text text-transparent" style={{WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent'}}>
                                    Digital Tasbih
                                </h1>
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={() => {
                                        setShowHistory(false);
                                        setShowSettings(false);
                                    }}
                                    className="p-2 hover:bg-cyan-500/20 rounded-xl transition-all border border-cyan-500/30 backdrop-blur-sm group"
                                >
                                    <div className="w-4 h-4 text-cyan-400 group-hover:drop-shadow-[0_0_8px_rgba(34,211,238,0.8)] transition">
                                        <Home />
                                    </div>
                                </button>
                                <button
                                    onClick={() => setShowHistory(!showHistory)}
                                    className="p-2 hover:bg-emerald-500/20 rounded-xl transition-all border border-emerald-500/30 backdrop-blur-sm group"
                                >
                                    <div className="w-4 h-4 text-emerald-400 group-hover:drop-shadow-[0_0_8px_rgba(52,211,153,0.8)] transition">
                                        <History />
                                    </div>
                                </button>
                                <button
                                    onClick={() => setShowSettings(!showSettings)}
                                    className="p-2 hover:bg-teal-500/20 rounded-xl transition-all border border-teal-500/30 backdrop-blur-sm group"
                                >
                                    <div className="w-4 h-4 text-teal-400 group-hover:drop-shadow-[0_0_8px_rgba(45,212,191,0.8)] transition">
                                        <Settings />
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <div className="flex-1 flex items-center justify-center p-4 relative z-10 overflow-y-auto overflow-x-hidden">
                        {!showHistory && !showSettings && (
                            <div className="w-full max-w-md pb-4">
                                {/* Dhikr Selection */}
                                <div className="mb-4">
                                    <div className="grid grid-cols-2 gap-3">
                                        {dhikrList.map((dhikr) => (
                                            <button
                                                key={dhikr.id}
                                                onClick={() => selectDhikr(dhikr)}
                                                className={`relative p-3 rounded-2xl backdrop-blur-xl transition-all duration-300 group overflow-hidden ${
                                                    selectedDhikr.id === dhikr.id
                                                        ? 'bg-gradient-to-br from-emerald-500/30 to-teal-500/30 border-2 border-emerald-400/50 shadow-[0_0_30px_rgba(52,211,153,0.3)]'
                                                        : 'bg-white/5 border-2 border-white/10 hover:border-emerald-400/30 hover:bg-white/10'
                                                }`}
                                            >
                                                {selectedDhikr.id === dhikr.id && (
                                                    <div className="absolute inset-0 bg-gradient-to-br from-emerald-400/20 to-teal-400/20 blur-xl"></div>
                                                )}
                                                <div className="relative">
                                                    <div className={`font-bold text-base mb-1 ${
                                                        selectedDhikr.id === dhikr.id ? 'text-emerald-300' : 'text-white/90'
                                                    }`}>
                                                        {dhikr.phrase}
                                                    </div>
                                                    <div className={`text-xs ${
                                                        selectedDhikr.id === dhikr.id ? 'text-emerald-400/80' : 'text-white/50'
                                                    }`}>
                                                        Goal: {dhikr.goal}
                                                    </div>
                                                </div>
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {/* Selected Dhikr Display */}
                                <div className="text-center mb-4 relative">
                                    <h2 className="text-3xl font-bold bg-gradient-to-r from-emerald-300 via-teal-300 to-cyan-300 bg-clip-text text-transparent mb-1" style={{WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', filter: 'drop-shadow(0 0 15px rgba(52,211,153,0.5))'}}>
                                        {selectedDhikr.phrase}
                                    </h2>
                                    <p className="text-emerald-400/70 italic text-xs">{selectedDhikr.translation}</p>
                                </div>

                                {/* Counter Display */}
                                <div className="relative backdrop-blur-2xl bg-gradient-to-br from-white/5 to-white/10 rounded-3xl border-2 border-white/20 shadow-[0_8px_32px_rgba(0,0,0,0.3)] p-4 mb-4 overflow-hidden">
                                    {/* Glowing background effect */}
                                    <div className="absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-teal-500/5 blur-2xl"></div>
                                    
                                    <div className="relative z-10">
                                        {/* Progress Bar */}
                                        <div className="mb-4">
                                            <div className="h-2 bg-white/10 rounded-full overflow-hidden backdrop-blur-sm border border-white/20 relative">
                                                <div 
                                                    className="h-full bg-gradient-to-r from-emerald-400 via-teal-400 to-cyan-400 transition-all duration-500 relative overflow-hidden"
                                                    style={{ width: `${Math.min(progress, 100)}%` }}
                                                >
                                                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-pulse"></div>
                                                </div>
                                                <div 
                                                    className="absolute inset-0 bg-gradient-to-r from-emerald-400 via-teal-400 to-cyan-400 blur-md opacity-50"
                                                    style={{ width: `${Math.min(progress, 100)}%` }}
                                                ></div>
                                            </div>
                                            <div className="flex justify-between text-xs text-emerald-400/80 mt-2 font-semibold">
                                                <span>Progress</span>
                                                <span>{Math.round(progress)}%</span>
                                            </div>
                                        </div>

                                        {/* Count Display */}
                                        <div className="text-center mb-4">
                                            <div className="relative inline-block">
                                                <div className="text-6xl font-bold bg-gradient-to-r from-emerald-300 via-teal-300 to-cyan-300 bg-clip-text text-transparent mb-1" style={{WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', filter: 'drop-shadow(0 0 30px rgba(52,211,153,0.6))'}}>
                                                    {count}
                                                </div>
                                                <div className="absolute inset-0 text-6xl font-bold text-emerald-400 blur-2xl opacity-30">
                                                    {count}
                                                </div>
                                            </div>
                                            <div className="text-xl text-emerald-400/60 font-light">
                                                / {selectedDhikr.goal}
                                            </div>
                                        </div>

                                        {/* Tap Button */}
                                        <button
                                            onClick={incrementCount}
                                            className="relative w-full h-40 rounded-3xl overflow-hidden group active:scale-95 transition-transform duration-200"
                                        >
                                            <div className="absolute inset-0 bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 opacity-90"></div>
                                            <div className="absolute inset-0 bg-gradient-to-br from-emerald-400/50 via-teal-400/50 to-cyan-400/50 blur-xl group-hover:blur-2xl transition-all"></div>
                                            <div className="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
                                            
                                            {/* Animated border glow */}
                                            <div className="absolute inset-0 rounded-3xl border-2 border-emerald-300/50 group-hover:border-emerald-300/80 transition-all shadow-[inset_0_0_20px_rgba(52,211,153,0.3)]"></div>
                                            
                                            <div className="relative h-full flex items-center justify-center">
                                                <div className="text-center">
                                                    <div className="text-xl font-bold text-white mb-1" style={{textShadow: '0 2px 10px rgba(0,0,0,0.3)'}}>
                                                        TAP TO COUNT
                                                    </div>
                                                    <div className="text-xs text-emerald-100/80">
                                                        Press anywhere
                                                    </div>
                                                </div>
                                            </div>
                                        </button>
                                    </div>
                                </div>

                                {/* Reset Button */}
                                <button
                                    onClick={resetCount}
                                    className="w-full flex items-center justify-center gap-2 p-3 backdrop-blur-xl bg-white/5 border-2 border-white/20 text-emerald-400 rounded-2xl hover:bg-white/10 hover:border-emerald-400/40 transition-all group"
                                >
                                    <div className="w-4 h-4 group-hover:rotate-180 transition-transform duration-500">
                                        <RotateCcw />
                                    </div>
                                    <span className="font-semibold text-sm">Reset Counter</span>
                                </button>
                            </div>
                        )}

                        {/* History View */}
                        {showHistory && (
                            <div className="w-full max-w-md h-full flex items-start pt-4">
                                <div className="backdrop-blur-2xl bg-gradient-to-br from-white/10 to-white/5 rounded-3xl border-2 border-white/20 shadow-[0_8px_32px_rgba(0,0,0,0.3)] p-4 w-full max-h-full overflow-hidden flex flex-col">
                                    <div className="flex items-center justify-between mb-4 flex-shrink-0">
                                        <h2 className="text-xl font-bold bg-gradient-to-r from-emerald-300 to-teal-300 bg-clip-text text-transparent" style={{WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent'}}>
                                            History
                                        </h2>
                                        {history.length > 0 && (
                                            <button
                                                onClick={clearHistory}
                                                className="text-red-400 hover:text-red-300 text-xs flex items-center gap-1 px-2 py-1 backdrop-blur-xl bg-red-500/10 border border-red-500/30 rounded-xl hover:bg-red-500/20 transition-all"
                                            >
                                                <div className="w-3 h-3">
                                                    <Trash2 />
                                                </div>
                                                Clear
                                            </button>
                                        )}
                                    </div>

                                    {history.length === 0 ? (
                                        <div className="text-center py-8 flex-shrink-0">
                                            <div className="text-emerald-400/40 text-5xl mb-3">ðŸ“¿</div>
                                            <p className="text-emerald-400/60 text-sm">No history yet. Start counting!</p>
                                        </div>
                                    ) : (
                                        <div className="space-y-2 overflow-y-auto pr-2 custom-scrollbar flex-1">
                                            {history.map((entry) => (
                                                <div
                                                    key={entry.id}
                                                    className={`relative p-3 rounded-2xl backdrop-blur-xl border-2 transition-all group ${
                                                        entry.completed
                                                            ? 'bg-emerald-500/10 border-emerald-500/30 hover:border-emerald-400/50 hover:bg-emerald-500/20'
                                                            : 'bg-white/5 border-white/20 hover:border-white/30 hover:bg-white/10'
                                                    }`}
                                                >
                                                    {entry.completed && (
                                                        <div className="absolute inset-0 bg-gradient-to-br from-emerald-400/10 to-teal-400/10 blur-xl rounded-2xl"></div>
                                                    )}
                                                    <div className="relative flex items-start justify-between">
                                                        <div className="flex-1">
                                                            <div className="font-bold text-white text-sm">{entry.phrase}</div>
                                                            <div className="flex items-center gap-2 mt-0.5">
                                                                <div className="text-xs text-emerald-400/80">
                                                                    {entry.count} / {entry.goal}
                                                                </div>
                                                                {entry.completed && (
                                                                    <span className="px-1.5 py-0.5 bg-emerald-500/30 border border-emerald-400/50 rounded-full text-xs text-emerald-300 font-semibold">
                                                                        âœ“ Completed
                                                                    </span>
                                                                )}
                                                            </div>
                                                        </div>
                                                        <div className="text-xs text-emerald-400/50">
                                                            {formatDate(entry.date)}
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}

                        {/* Settings View */}
                        {showSettings && (
                            <div className="w-full max-w-md h-full flex items-start pt-4">
                                <div className="backdrop-blur-2xl bg-gradient-to-br from-white/10 to-white/5 rounded-3xl border-2 border-white/20 shadow-[0_8px_32px_rgba(0,0,0,0.3)] p-4 w-full max-h-full overflow-y-auto custom-scrollbar">
                                    <h2 className="text-xl font-bold bg-gradient-to-r from-emerald-300 to-teal-300 bg-clip-text text-transparent mb-4" style={{WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent'}}>
                                        Settings
                                    </h2>

                                    {/* Vibration Toggle */}
                                    <div className="mb-4 pb-4 border-b border-white/10">
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <div className="font-semibold text-white text-sm">Haptic Feedback</div>
                                                <div className="text-xs text-emerald-400/60">Vibrate on tap</div>
                                            </div>
                                            <button
                                                onClick={() => setVibrationEnabled(!vibrationEnabled)}
                                                className={`relative w-14 h-7 rounded-full transition-all duration-300 ${
                                                    vibrationEnabled 
                                                        ? 'bg-gradient-to-r from-emerald-500 to-teal-500 shadow-[0_0_20px_rgba(52,211,153,0.5)]' 
                                                        : 'bg-white/10 border-2 border-white/20'
                                                }`}
                                            >
                                                <div
                                                    className={`absolute top-0.5 w-6 h-6 bg-white rounded-full shadow-lg transition-all duration-300 ${
                                                        vibrationEnabled ? 'left-7 shadow-[0_0_10px_rgba(255,255,255,0.8)]' : 'left-0.5'
                                                    }`}
                                                />
                                            </button>
                                        </div>
                                    </div>

                                    {/* Add New Dhikr Section */}
                                    <div className="mb-4 pb-4 border-b border-white/10">
                                        <div className="flex items-center justify-between mb-3">
                                            <h3 className="font-semibold text-white text-sm">Manage Dhikr</h3>
                                            <button
                                                onClick={() => setShowAddDhikr(!showAddDhikr)}
                                                className="flex items-center gap-1 px-3 py-1.5 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl hover:shadow-[0_0_20px_rgba(52,211,153,0.4)] transition-all text-xs font-semibold border border-emerald-400/30"
                                            >
                                                <div className="w-3 h-3">
                                                    <Plus />
                                                </div>
                                                Add New
                                            </button>
                                        </div>

                                        {/* Add Dhikr Form */}
                                        {showAddDhikr && (
                                            <div className="backdrop-blur-xl bg-emerald-500/10 border-2 border-emerald-500/30 p-4 rounded-2xl mb-4">
                                                <h4 className="font-semibold text-emerald-300 mb-3 text-sm">Add Custom Dhikr</h4>
                                                <div className="space-y-3">
                                                    <div>
                                                        <label className="block text-xs text-emerald-400/80 mb-1.5">Dhikr Phrase *</label>
                                                        <input
                                                            type="text"
                                                            value={newDhikr.phrase}
                                                            onChange={(e) => setNewDhikr({...newDhikr, phrase: e.target.value})}
                                                            placeholder="e.g., La ilaha illallah"
                                                            className="w-full px-3 py-2.5 backdrop-blur-xl bg-white/5 border-2 border-white/20 rounded-xl text-sm text-white placeholder-white/40 focus:border-emerald-400/50 focus:outline-none transition-all"
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="block text-xs text-emerald-400/80 mb-1.5">Translation (optional)</label>
                                                        <input
                                                            type="text"
                                                            value={newDhikr.translation}
                                                            onChange={(e) => setNewDhikr({...newDhikr, translation: e.target.value})}
                                                            placeholder="e.g., There is no god but Allah"
                                                            className="w-full px-3 py-2.5 backdrop-blur-xl bg-white/5 border-2 border-white/20 rounded-xl text-sm text-white placeholder-white/40 focus:border-emerald-400/50 focus:outline-none transition-all"
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="block text-xs text-emerald-400/80 mb-1.5">Goal</label>
                                                        <input
                                                            type="number"
                                                            value={newDhikr.goal}
                                                            onChange={(e) => setNewDhikr({...newDhikr, goal: e.target.value})}
                                                            className="w-full px-3 py-2.5 backdrop-blur-xl bg-white/5 border-2 border-white/20 rounded-xl text-sm text-white focus:border-emerald-400/50 focus:outline-none transition-all"
                                                            min="1"
                                                        />
                                                    </div>
                                                    <div className="flex gap-2 pt-2">
                                                        <button
                                                            onClick={addNewDhikr}
                                                            className="flex-1 py-2.5 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl hover:shadow-[0_0_20px_rgba(52,211,153,0.4)] transition-all text-sm font-semibold"
                                                        >
                                                            Add Dhikr
                                                        </button>
                                                        <button
                                                            onClick={() => {
                                                                setShowAddDhikr(false);
                                                                setNewDhikr({ phrase: '', translation: '', goal: 33 });
                                                            }}
                                                            className="flex-1 py-2.5 backdrop-blur-xl bg-white/10 border-2 border-white/20 text-white rounded-xl hover:bg-white/20 transition-all text-sm font-semibold"
                                                        >
                                                            Cancel
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        )}

                                        {/* Dhikr List */}
                                        <div className="space-y-2 max-h-48 overflow-y-auto pr-2 custom-scrollbar">
                                            {dhikrList.map((dhikr) => (
                                                <div key={dhikr.id}>
                                                    {editingDhikr === dhikr.id ? (
                                                        // Edit Form
                                                        <div className="backdrop-blur-xl bg-teal-500/10 border-2 border-teal-500/30 p-4 rounded-2xl">
                                                            <h4 className="font-semibold text-teal-300 mb-3 text-sm">Edit Dhikr</h4>
                                                            <div className="space-y-3">
                                                                <div>
                                                                    <label className="block text-xs text-teal-400/80 mb-1.5">Dhikr Phrase *</label>
                                                                    <input
                                                                        type="text"
                                                                        value={editForm.phrase}
                                                                        onChange={(e) => setEditForm({...editForm, phrase: e.target.value})}
                                                                        className="w-full px-3 py-2.5 backdrop-blur-xl bg-white/5 border-2 border-white/20 rounded-xl text-sm text-white placeholder-white/40 focus:border-teal-400/50 focus:outline-none transition-all"
                                                                    />
                                                                </div>
                                                                <div>
                                                                    <label className="block text-xs text-teal-400/80 mb-1.5">Translation</label>
                                                                    <input
                                                                        type="text"
                                                                        value={editForm.translation}
                                                                        onChange={(e) => setEditForm({...editForm, translation: e.target.value})}
                                                                        className="w-full px-3 py-2.5 backdrop-blur-xl bg-white/5 border-2 border-white/20 rounded-xl text-sm text-white placeholder-white/40 focus:border-teal-400/50 focus:outline-none transition-all"
                                                                    />
                                                                </div>
                                                                <div>
                                                                    <label className="block text-xs text-teal-400/80 mb-1.5">Goal</label>
                                                                    <input
                                                                        type="number"
                                                                        value={editForm.goal}
                                                                        onChange={(e) => setEditForm({...editForm, goal: e.target.value})}
                                                                        className="w-full px-3 py-2.5 backdrop-blur-xl bg-white/5 border-2 border-white/20 rounded-xl text-sm text-white focus:border-teal-400/50 focus:outline-none transition-all"
                                                                        min="1"
                                                                    />
                                                                </div>
                                                                <div className="flex gap-2 pt-2">
                                                                    <button
                                                                        onClick={updateDhikr}
                                                                        className="flex-1 py-2.5 bg-gradient-to-r from-teal-500 to-cyan-500 text-white rounded-xl hover:shadow-[0_0_20px_rgba(45,212,191,0.4)] transition-all text-sm font-semibold"
                                                                    >
                                                                        Save Changes
                                                                    </button>
                                                                    <button
                                                                        onClick={cancelEditing}
                                                                        className="flex-1 py-2.5 backdrop-blur-xl bg-white/10 border-2 border-white/20 text-white rounded-xl hover:bg-white/20 transition-all text-sm font-semibold"
                                                                    >
                                                                        Cancel
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    ) : (
                                                        // Display Mode
                                                        <div className="flex items-center gap-3 p-4 backdrop-blur-xl bg-gradient-to-br from-emerald-500/15 to-teal-500/15 border-2 border-emerald-400/30 rounded-xl hover:bg-gradient-to-br hover:from-emerald-500/25 hover:to-teal-500/25 hover:border-emerald-400/50 transition-all group shadow-[0_0_15px_rgba(52,211,153,0.1)]">
                                                            <div className="flex-1 min-w-0">
                                                                <div className="font-bold text-white text-sm truncate drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]">{dhikr.phrase}</div>
                                                                <div className="text-xs text-emerald-200 truncate font-medium drop-shadow-[0_1px_2px_rgba(0,0,0,0.6)]">{dhikr.translation}</div>
                                                            </div>
                                                            <div className="flex items-center gap-2 flex-shrink-0">
                                                                <span className="text-xs text-white/90 font-semibold drop-shadow-[0_1px_2px_rgba(0,0,0,0.6)]">Goal:</span>
                                                                <input
                                                                    type="number"
                                                                    value={dhikr.goal}
                                                                    onChange={(e) => {
                                                                        const updated = dhikrList.map(d => 
                                                                            d.id === dhikr.id ? { ...d, goal: parseInt(e.target.value) } : d
                                                                        );
                                                                        setDhikrList(updated);
                                                                        if (selectedDhikr.id === dhikr.id) {
                                                                            setSelectedDhikr({ ...dhikr, goal: parseInt(e.target.value) });
                                                                        }
                                                                    }}
                                                                    className="w-16 px-2 py-1.5 backdrop-blur-xl bg-white/90 border-2 border-emerald-400/40 rounded-lg text-center text-sm text-gray-900 font-bold focus:border-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-400/30 transition-all"
                                                                    min="1"
                                                                />
                                                                <button
                                                                    onClick={() => startEditingDhikr(dhikr)}
                                                                    className="p-2 text-white hover:bg-teal-400/30 border-2 border-teal-400/50 rounded-lg transition-all hover:text-teal-100 hover:border-teal-300 hover:shadow-[0_0_10px_rgba(45,212,191,0.3)]"
                                                                >
                                                                    <div className="w-4 h-4">
                                                                        <Edit2 />
                                                                    </div>
                                                                </button>
                                                                <button
                                                                    onClick={() => deleteDhikr(dhikr.id)}
                                                                    className="p-2 text-red-300 hover:bg-red-400/30 border-2 border-red-400/50 rounded-lg transition-all hover:text-red-100 hover:border-red-300 hover:shadow-[0_0_10px_rgba(239,68,68,0.3)]"
                                                                >
                                                                    <div className="w-4 h-4">
                                                                        <Trash2 />
                                                                    </div>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    )}
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Quick Goal Presets */}
                                    <div className="mb-2">
                                        <h3 className="font-semibold text-white mb-2 text-sm">Quick Presets</h3>
                                        <div className="grid grid-cols-4 gap-2">
                                            {[33, 99, 100, 1000].map((preset) => (
                                                <button
                                                    key={preset}
                                                    onClick={() => updateGoal(preset)}
                                                    className="p-2 backdrop-blur-xl bg-emerald-500/20 border-2 border-emerald-400/30 text-emerald-300 rounded-xl hover:bg-emerald-500/30 hover:shadow-[0_0_15px_rgba(52,211,153,0.3)] transition-all font-bold text-sm"
                                                >
                                                    {preset}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Footer Navigation */}
                    {(showHistory || showSettings) && (
                        <div className="relative p-3 backdrop-blur-xl bg-gradient-to-r from-emerald-600/20 to-teal-600/20 border-t border-emerald-500/30 flex-shrink-0">
                            <button
                                onClick={() => {
                                    setShowHistory(false);
                                    setShowSettings(false);
                                }}
                                className="w-full max-w-md mx-auto block p-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-2xl font-bold hover:shadow-[0_0_30px_rgba(52,211,153,0.5)] transition-all border border-emerald-400/30 text-sm"
                            >
                                Back to Counter
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TasbihApp />);
    </script>
</body>
</html>
